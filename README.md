# Космическая птицефабрика

Игра-симулятор управления птицефермой на космическом корабле.

## Структура проекта

### game.js

Основной файл инициализации игры. Здесь задаются настройки и запускается начальная сцена.

```javascript
export const game = new Game(800, 600);
game.debugCollider = true; // Включение отладки коллайдеров

// Запуск игры с начальной сценой
game.run(new MonitorStage());
```

**Режимы запуска:**
- В режиме разработки: `game.run(new MonitorStage())`
- В продакшене: `game.run(new MenuStage())`

## Архитектура сцен

### Основные сцены (Stages)

- **MenuStage** - стартовая сцена с меню игры
- **IntroStage** - вводная сцена с предысторией
- **OutroStage** - финальная сцена при успешном завершении
- **GameOverStage** - сцена проигрыша (в разработке)
- **MonitorStage** - главный экран управления птицефабрикой
- **\*RoomStage** - сцены отдельных помещений (наследуются от AbstractRootStage)

### Базовые классы сцен

#### AbstractStage
Базовый класс для всех сцен. Реализует общие методы:
- `drawMultilineText()` - отображение текста в несколько строк

#### AbstractRootStage
Абстрактный класс для сцен-комнат. Обязательные методы для реализации:
- `getLabel()` - возвращает название комнаты
- `getBackgroundImage()` - возвращает путь к фоновому изображению
- `getThumbnailImage()` - возвращает путь к миниатюре для экрана монитора
- `resetRoom()` - сбрасывает состояние комнаты при перезапуске игры
- `roomTick()` - вызывается каждый игровой тик для обновления состояния комнаты

Комнаты имеют состояние `active` и метод `activate()` для активации.

#### AbstractSlideStage
Базовый класс для сцен со слайдами (IntroStage, OutroStage, GameOverStage). Реализует логику переключения слайдов с текстом.

#### MonitorStage
Главная сцена игры. Отображает миниатюры всех комнат и общие показатели.

**Особенности:**
- Реализует игровой цикл через `gameTick()`
- Обновляет состояние каждую секунду
- Координирует работу всех комнат
- Является центральным хабом управления

При переходе на сцену комнаты (`*RoomStage`), комната вызывает метод `MonitorStage.gameTick()` - это костыльное решение пока нет возможности сделать forever для game.

## Система спрайтов

### AbstractButtonSprite
Абстрактный класс для кнопок с методами:
- `onClick()` - обработчик клика
- `setLabel()` - установка текста кнопки

### ButtonSprite
Конкретная реализация игровой кнопки. Наследует AbstractButtonSprite.

### ThumbnailRoomSprite
Спрайт для отображения миниатюры комнаты на главном мониторе. Также является кнопкой для перехода в комнату.

## Сервисы и утилиты

### GameState
Синглтон для хранения глобального состояния игры. Содержит:
- Игровое время и ресурсы
- Показатели производства
- Статусы миссий

```javascript
const gameState = GameState.getInstance();
gameState.time += 1;
```

### ThumbnailRoomFactory
Фабрика для создания спрайтов миниатюр комнат (`ThumbnailRoomSprite`).

## Разработка

### Добавление новой комнаты
1. Создать класс, унаследованный от AbstractRootStage
2. Реализовать все обязательные методы
3. Добавить миниатюру и фоновое изображение
4. Зарегистрировать в ThumbnailRoomFactory

### Игровой цикл
- Каждую секунду вызывается `gameTick()` в MonitorStage
- Обновляется глобальное время в GameState
- Вызываются методы `roomTick()` для активных комнат

### Запуск и отладка
Для отладки включите режим коллайдеров: `game.debugCollider = true`
